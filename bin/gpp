#!/usr/bin/env python3

import sys

sys.path.append('/opt/py')

import gitdir.host
import pathlib
import subprocess

if __name__ == '__main__':
    subprocess.run(['git', 'push'], check=True)
    try:
        repo, kind = gitdir.host.Repo.lookup(pathlib.Path())
    except LookupError:
        sys.exit()
    if kind == 'stage':
        repo.deploy()
